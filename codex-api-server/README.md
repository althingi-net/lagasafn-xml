# Edithing Python

A Django project using Django Ninja for API development, uv as the package manager, and mypy for type checking.

## Prerequisites

- Python 3.13+
- [uv](https://docs.astral.sh/uv/) package manager

## Installation

### 1. Install uv (if not already installed)

```bash
# On macOS and Linux
curl -LsSf https://astral.sh/uv/install.sh | sh

# On Windows
powershell -c "irm https://astral.sh/uv/install.ps1 | iex"

# Or via pip
pip install uv
```

### 2. Install project dependencies

```bash
# Install all dependencies from pyproject.toml
uv sync

# Or install in development mode
uv sync --dev
```

## Usage

### Running the Development Server

```bash
# Activate the virtual environment and run Django
uv run manage.py runserver
```

The API will be available at:
- Main API endpoint: `http://localhost:8000/api/`
- Django admin: `http://localhost:8000/admin/`
- API documentation: `http://localhost:8000/api/docs` (automatically generated by Django Ninja)

### Django Ninja API

This project uses [Django Ninja](https://django-ninja.rest-framework.com/) for building APIs. The main API configuration is in `web/api.py`.

#### Creating API Endpoints

```python
# In web/api.py
from ninja import NinjaAPI

api = NinjaAPI()

@api.get("/hello")
def hello(request):
    return {"message": "Hello World"}

@api.post("/items")
def create_item(request, item: ItemSchema):
    # Your logic here
    return {"status": "created"}
```

#### API Features

- **Automatic OpenAPI documentation**: Visit `/api/docs` for interactive API docs
- **Type hints**: Full support for Python type hints and Pydantic models
- **Fast**: Built on top of Django with performance optimizations
- **Easy testing**: Simple unit testing with Django's test framework

### Package Management with uv

uv is a fast Python package manager and resolver written in Rust.

#### Common Commands

```bash
# Add a new dependency
uv add package-name

# Add a development dependency
uv add --dev package-name

# Remove a dependency
uv remove package-name

# Update dependencies
uv sync --upgrade

# Install from lock file (production)
uv sync --frozen

# Run commands in the virtual environment
uv run python manage.py migrate
uv run python manage.py createsuperuser
uv run python manage.py collectstatic
```

#### Virtual Environment

uv automatically manages virtual environments:

```bash
# Activate the virtual environment
source .venv/bin/activate  # On Unix/macOS
# or
.venv\Scripts\activate     # On Windows

# Or run commands directly with uv
uv run python manage.py shell
```

### Type Checking with mypy

This project includes [mypy](https://mypy.readthedocs.io/) for static type checking.

#### Running Type Checks

```bash
# Run mypy on the entire project
uv run mypy .

# Run mypy on specific files
uv run mypy web/api.py

# Run with Django support (already configured in pyproject.toml)
uv run mypy . --config-file pyproject.toml

# Run with less strict checking for development
uv run mypy . --ignore-missing-imports
```

#### Type Checking Best Practices

1. **Add type hints to function signatures:**
```python
def create_user(name: str, age: int) -> dict[str, any]:
    return {"name": name, "age": age}
```

2. **Use Pydantic models for API schemas:**
```python
from pydantic import BaseModel

class UserSchema(BaseModel):
    name: str
    age: int
    email: str
```

3. **Configure mypy in pyproject.toml:**
```toml
[tool.mypy]
python_version = "3.13"
strict = true
warn_return_any = true
```

## Database

### Migrations

```bash
# Create migrations
uv run python manage.py makemigrations

# Apply migrations
uv run python manage.py migrate
```

### Admin Interface

```bash
# Create a superuser
uv run python manage.py createsuperuser
```

## Development Workflow

1. **Start development server:**
```bash
uv run python manage.py runserver
```

2. **Run type checking:**
```bash
uv run mypy .
```

3. **Test your API:**
   - Visit `http://localhost:8000/api/docs` for interactive documentation
   - Use the automatically generated OpenAPI schema

4. **Add new dependencies:**
```bash
uv add new-package
```

## Project Structure

```
edithing_python/
├── web/
│   ├── __init__.py
│   ├── api.py          # Django Ninja API definition
│   ├── asgi.py
│   ├── settings.py     # Django settings
│   ├── urls.py         # URL configuration
│   └── wsgi.py
├── manage.py           # Django management script
├── pyproject.toml      # Project dependencies and configuration
├── uv.lock            # Locked dependency versions
└── README.md
```

## Contributing

1. Fork the repository
2. Create a feature branch
3. Add type hints to new code
4. Run mypy to check for type errors
5. Test your changes
6. Submit a pull request
